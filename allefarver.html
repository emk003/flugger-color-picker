<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <script src="https://kit.fontawesome.com/a4b7cedec2.js" crossorigin="anonymous"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <title>flügger</title>
  <link href="https://fonts.googleapis.com/css2?family=Actor&family=Inter:ital,opsz,wght@0,14..32,100..900;1,14..32,100..900&family=Space+Grotesk:wght@300..700&display=swap" rel="stylesheet">
  </head>

<style>
  /* Hele body-elementet: sæt margin til 0, brug skrifttype Inter, og baggrund som hvid */
  body {
    margin: 0;
    font-family: "Inter", sans-serif;
    background-color: white;
  }

  /* Headeren får hvid baggrund */
  header {
    background-color: #fff;
  }

  /* Sort bjælke med USP (unik salgs-pointe) tekst */
  .USP-bar-ek {
    background-color: #363433;
    padding: 0.5rem 0.5rem;
    text-align: center;
    font-size: 0.9rem;
    color: white;
  }

  /* Indhold i header: logo og ikoner vises side om side */
  .header-indhold-ek {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 1rem 2rem;
    background-color: white;
  }

  /* Logoet: maks bredde 150px, og højden justeres automatisk */
  .logo-ek {
    max-width: 150px;
    height: auto;
  }

  /* Ikoner (søg, kurv, menu): vises i række med mellemrum */
  .ikoner-ek {
    display: flex;
    gap: 1rem;
    font-size: 1.8rem;
  }

  /* Topmenu til valg ("vælg farve" / "farvelæg") */
  .valg-ek {
    display: flex;
    justify-content: center;
    align-items: center;
    gap: 2rem;
    background-color: white;
    margin-top: 2rem;
  }

  /* Lodret streg mellem valg */
  .opdeler-ek {
    width: 1px;
    align-self: stretch;
    background-color: black;
  }

  /* Den valgte sektion får understregning */
  .valgt-ek {
    border-bottom: 2px solid #000;
    padding-bottom: 0.2rem;
  }

  /* Ikke-valgte er normal i stilen */
  .ikke-valgt-ek {
    font-weight: normal;
  }

  .valgt-ek a {
    text-decoration: none;
    color: inherit;
  }

  .ikke-valgt-ek a {
    text-decoration: none;
    color: inherit;
  }

  /* Overskriften */
  h3{
    margin: 2rem;
    font-size: 2rem;
  }

  /* styling til søgefeltet */
  .sogefelt-ek {
    display: flex;
    align-items: center;
    margin: 2rem 2rem 0;
    padding: 1rem;
    font-size: 1rem;
    width: 75%;
    border: 1px solid #000000;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
  }

  /* Selve inputfeltet i søgningen */
  #sogInput-ek {
    font-size: 1.2rem;
    border: transparent;
  }

  /* Ikonet i søgefeltet */
  .sogefelt-ek i {
    color: #000000;
    font-size: 1.2rem;
    padding: 0.5rem;
  }

  /* Containeren hvor farverne vises som grid */
  .farve-container-ek {
    display: grid;
    grid-template-columns: repeat(2, 1fr); /* 2 kolonner */
    gap: 1rem;
    padding: 2rem;
  }

  /* Hver farveboks har position og skjuler overløb */
  .farveboks-ek {
    position: relative;
    overflow: hidden;
  }

  /* Selve farvevisningen (den farvede firkant) */
  .farve-ek {
    height: 100px;
    background-size: cover;
    background-repeat: no-repeat;
    background-position: center;
    background-blend-mode: multiply;
  }

  /* Informationsfeltet under hver farve */
  .info-ek {
    padding-top: 0.5rem;
    background: white;
    padding-bottom: 2rem;
  }

  /* navnet på farven i farvekortet */
  .info-ek h4 {
    margin: 0 0 0.25rem;
    font-size: 1rem;
  }

  /* farvekoden i farvekortet */
  .info-ek p {
    margin: 0;
    font-size: 0.875rem;
    color: #555;
  }

  /* Øverste infofelt med navn og knap */
  .info-top-ek {
    display: flex;
    justify-content: space-between;
    align-items: center;
  }

  /* Plus/tilføj-knappen i farvekortet */
  .tilfoej-knap-ek {
    width: 30px;
    height: 30px;
    border: 1px solid black;
    border-radius: 50%;
    font-size: 1.5rem;
    font-weight: bold;
    background: white;
    color: black;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: background 0.2s ease;
  }

  /* Hvis farven er valgt: vis orange baggrund på tilføj ikonet */
  .tilfoej-knap-ek.selected {
    background: #E67E23;
    color: black;
    border: 1px solid #E67E23;
  }

  /* Ikonet inde i knappen, tilføj ikonet i farvekortet */
  .ikon-ek {
    font-size: 1.5rem;
    font-weight: lighter;
    color: black;
    transition: color 0.2s ease, transform 0.2s ease;
  }

  /* Hvis farven er valgt: gør ikonet mindre og hvidt i farvekortet */
  .tilfoej-knap-ek.selected .ikon-ek {
    color: white;
    transform: scale(0.8);
  }

  /* Popup med valgte farver, fast i bunden af skærmen */
  .valg-popup-ek {
    position: fixed;
    bottom: 0;
    left: 0;
    width: 100%;
    background: white;
    box-shadow: 0 -2px 10px rgba(0, 0, 0, 0.2);
    padding: 1rem;
    display: flex;
    justify-content: center;
    align-items: center;
    z-index: 1000;
    gap: 1rem;
  }

  /* De valgte farver vises side om side og kan gå på næste linje i pop uppen */
  .valgte-farver-ek {
    display: flex;
    gap: 0.5rem;
    flex-wrap: wrap;
  }

  /* Gør popup'en usynlig hvis den har klassen 'hidden' */
  .valg-popup-ek.hidden {
    display: none;
  }

  /* Lille forhåndsvisning af valgt farve i pop uppen */
  .valgte-farver-ek .farve-preview-ek {
    width: 50px;
    height: 50px;
    position: relative;
  }

  /* Knappen til at fjerne en valgt farve i pop uppen */
  .farve-preview-ek .fjern-knap-ek {
    position: absolute;
    top: -5px;
    right: -5px;
    background: white;
    border: 1px solid #000;
    border-radius: 50%;
    width: 18px;
    height: 18px;
    font-size: 12px;
    text-align: center;
    cursor: pointer;
    line-height: 16px;
  }

  /* Den store blå 'Tilføj' knap i bunden af pop uppen */
  #tilfoejListe-ek {
    height: 50px;
    padding: 0 1.5rem;
    background-color: #1E32DA;
    color: white;
    font-size: 1rem;
    border: none;
    cursor: pointer;
    align-self: center;
    display: flex;
    align-items: center;
    justify-content: center;
  }

  /* Container til filtrene med bredde og marginer */
  .filter-container-ek {
    width: 84%;
    margin: 1rem 2rem 0;
  }

  /* Udseende for hver filterboks */
  .filter-ek {
    border: 1px solid #000;
    padding: 1rem;
    margin-bottom: 1rem;
    cursor: pointer;
    position: relative; /* Nødvendig for at placere ::after absolut i forhold til denne */
  }

  /* Pil-ikon (▾) som vises til højre i filterboksen */
  .filter-ek::after {
    content: '▾';
    position: absolute;
    right: 1rem;
    top: 50%;
    transform: translateY(-50%); /* Centrerer vertikalt */
  }

  /* Dropdown-menu med filtervalg, som er skjult som standard */
  .dropdown-options {
    display: none;
    border: 1px solid #000;
    border-top: none; /* Fjerner topgrænsen for at undgå dobbeltkant */
    padding: 0.5rem;
    background: #fff;
    position: absolute;
    width: 94%;
    left: 0;
    top: 100%; /* Placér direkte under filter-ek */
    z-index: 10; /* Sørger for at dropdown vises over andet indhold */
    max-height: 200px;
    overflow-y: auto; /* Scroll hvis indholdet overstiger max-højde */
  }

  /* Udseende for hvert label inde i dropdownen */
  .dropdown-options label {
    display: block;
    margin-bottom: 0.5rem;
    cursor: pointer;
    font-size: 0.95rem;
  }

  /* Margin til checkboxen foran teksten */
  .dropdown-options input[type="checkbox"] {
    margin-right: 0.5rem;
  }

  /* Når filterboksen er åben, vis dropdownen */
  .filter-ek.open .dropdown-options {
    display: block;
  }

  /* Ekstra div-elementer i dropdown (hvis brugt til klikbare valg) */
  .dropdown-options div {
    padding: 0.5rem;
    cursor: pointer;
  }

  /* Hover-effekt på dropdown-elementer */
  .dropdown-options div:hover {
    background-color: #f0f0f0;
  }
</style>

<body>
<!-- Header med USP og logo + ikoner -->
<header>
  <!-- USP-bar med info om returret -->
  <div class="USP-bar-ek">
    <p>30 dages returret</p>
  </div>

  <!-- Hovedindholdet i headeren: logo og ikoner -->
  <div class="header-indhold-ek">
    <!-- Virksomhedens logo -->
    <img class="logo-ek" src="fotos/logo.png" alt="logo">

    <!-- Ikoner til søgning, kurv og menu -->
    <div class="ikoner-ek">
      <i class="fa-solid fa-magnifying-glass"></i>
      <i class="fa-solid fa-basket-shopping"></i>
      <i class="fa-solid fa-bars"></i>
    </div>
  </div>
</header>

<!-- Sektion til valg mellem "Vælg farve" og "Farvelæg" -->
<div class="valg-ek">
  <!-- Valgt sektion med link til farvevalg -->
  <h2 class="valgt-ek"><a href="vælgfarve.html">Vælg farve</a></h2>

  <!-- Visuel opdeler mellem valgmuligheder -->
  <div class="opdeler-ek"></div>

  <!-- Ikke valgt sektion (kun tekst, ikke link) -->
  <h2 class="ikke-valgt-ek"><a href="main.html">Farvelæg</a></h2>
</div>

<!-- Overskrift for farvevisning -->
<h3>Alle farver</h3>

<!-- Søgefelt til filtrering af farver -->
<div class="sogefelt-ek">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="text" id="sogInput-ek" placeholder="Søg farver...">
</div>

<!-- Filtermuligheder til at sortere farver -->
<div class="filter-container-ek">
  <div class="filter-ek" data-filter="grundfarve">Filter efter grundfarve</div>
  <div class="filter-ek" data-filter="farvekort">Filter efter farvekort</div>
  <div class="filter-ek" data-filter="tone">Filter efter tone</div>
</div>

<!-- Container til visning af farveresultater -->
<div class="farve-container-ek" id="farveContainer-ek"></div>

<!-- Popup-vindue til at vise valgte farver og tilføjelsesknap -->
<div id="valgPopup-ek" class="valg-popup-ek hidden">
  <!-- Liste over valgte farver -->
  <div id="valgteFarver-ek" class="valgte-farver-ek"></div>

  <!-- Knap til at tilføje valgte farver -->
  <button id="tilfoejListe-ek">Tilføj</button>
</div>

<script src="database.js"></script>
<script>
  // Når hele HTML-dokumentet er færdigindlæst og klar til at blive manipuleret i DOM'en
  document.addEventListener("DOMContentLoaded", function () {
    // Hent forskellige DOM-elementer vi skal bruge senere

    const container = document.getElementById("farveContainer-ek");
    // Container hvor farverne skal vises som farvebokse

    const input = document.getElementById("sogInput-ek");
    // Inputfelt til søgning blandt farver

    const popup = document.getElementById("valgPopup-ek");
    // Popup der viser de valgte farver

    const valgteContainer = document.getElementById("valgteFarver-ek");
    // Container inde i popup'en, hvor valgte farver bliver vist

    const tilfoejKnap = document.getElementById("tilfoejListe-ek");
    // Knap til at bekræfte valgte farver og gå videre til næste side

    const filters = document.querySelectorAll(".filter-ek");
    // Alle filter-knapper, f.eks. "grundfarve", "tone", "farvekort"

    let valgteFarver = [];
    // Array der holder styr på hvilke farver brugeren har valgt

    const aktiveFiltre = {
      grundfarve: new Set(),
      farvekort: new Set(),
      tone: new Set()
    };
    // Objekt som holder aktive filtre i separate Set-objekter (fordi Set automatisk undgår dubletter)

    // Funktion der opdaterer og viser popup'en med valgte farver
    function visValgteFarver() {
      valgteContainer.innerHTML = ""; // Fjern alt tidligere indhold

      if (valgteFarver.length === 0) {
        popup.classList.add("hidden"); // Skjul popup hvis ingen farver er valgt
        return;
      }

      popup.classList.remove("hidden"); // Vis popup

      // Gå igennem hver valgt farve og tilføj den til popup'en
      valgteFarver.forEach(f => {
        const preview = document.createElement("div");
        preview.className = "farve-preview-ek";
        preview.style.backgroundColor = f.hex; // Farvevisning baseret på farvens HEX-kode

        const fjern = document.createElement("div");
        fjern.className = "fjern-knap-ek";
        fjern.textContent = "✕"; // Kryds for at fjerne farve

        // Når brugeren klikker på fjern-knappen
        fjern.addEventListener("click", function () {
          valgteFarver = valgteFarver.filter(f2 => f2.kode !== f.kode); // Fjern farven
          visValgteFarver(); // Opdater popup
          renderFarver(colorData); // Opdater farvebokse
        });

        preview.appendChild(fjern);
        valgteContainer.appendChild(preview);
      });
    }

    // Funktion der viser farver i hovedvisningen
    function renderFarver(data) {
      container.innerHTML = ""; // Ryd tidligere farver

      data.forEach(farve => {
        const boks = document.createElement("div");
        boks.className = "farveboks-ek";

        const farveDiv = document.createElement("div");
        farveDiv.className = "farve-ek";
        farveDiv.style.backgroundColor = farve.hex;

        // Hvis farven er en 'effekt', vis baggrundsbillede som tekstur
        if (farve.type === "effekt" && farve.tekstur) {
          farveDiv.style.backgroundImage = `url(fotos/tekstur3.png)`;
        }

        const farveWrapper = document.createElement("div");
        farveWrapper.style.position = "relative";
        farveWrapper.appendChild(farveDiv);

        // Informationssektion med navn, kode og knap
        const info = document.createElement("div");
        info.className = "info-ek";

        info.innerHTML = `
        <div class="info-top-ek">
          <h4>${farve.navn}</h4>
          <button class="tilfoej-knap-ek" aria-label="Tilføj farve">
            <span class="ikon-ek">
              ${valgteFarver.some(f => f.kode === farve.kode) ? "✔" : "+"}
            </span>
          </button>
        </div>
        <p>${farve.kode}</p>
      `;

        boks.appendChild(farveWrapper);
        boks.appendChild(info);
        container.appendChild(boks);

        const knap = info.querySelector(".tilfoej-knap-ek");
        const ikon = knap.querySelector(".ikon-ek");

        // Hvis farven allerede er valgt, vis det med ✔ og baggrund
        if (valgteFarver.some(f => f.kode === farve.kode)) {
          knap.classList.add("selected");
          boks.style.backgroundColor = "#f0f0f0";
        }

        // Når man klikker på tilføj-knappen
        knap.addEventListener("click", function () {
          const alleredeValgt = valgteFarver.some(f => f.kode === farve.kode);

          if (alleredeValgt) {
            // Hvis allerede valgt: fjern den
            valgteFarver = valgteFarver.filter(f => f.kode !== farve.kode);
            knap.classList.remove("selected");
            ikon.textContent = "+";
            boks.style.backgroundColor = "transparent";
          } else {
            // Hvis ikke valgt: tilføj den
            valgteFarver.push(farve);
            knap.classList.add("selected");
            ikon.textContent = "✔";
            boks.style.backgroundColor = "#f0f0f0";
          }

          visValgteFarver(); // Opdater popup
        });
      });
    }

    // Funktion til at filtrere farver baseret på de valgte filtre
    function filtrerFarver() {
      const filtreret = colorData.filter(f => {
        return (
                (aktiveFiltre.grundfarve.size === 0 || aktiveFiltre.grundfarve.has(f.grundfarve)) &&
                (aktiveFiltre.farvekort.size === 0 || aktiveFiltre.farvekort.has(f.farvekort)) &&
                (aktiveFiltre.tone.size === 0 || aktiveFiltre.tone.has(f.tone))
        );
      });

      renderFarver(filtreret);
    }

    // Søgefunktion: filtrerer farver baseret på søgetekst
    input.addEventListener("input", function () {
      const søgning = input.value.toLowerCase(); // Får søgestrengen i lowercase

      const filtreret = colorData.filter(f => {
        return (
                f.navn.toLowerCase().includes(søgning) ||
                f.kode.toLowerCase().includes(søgning) ||
                (f.grundfarve && f.grundfarve.toLowerCase().includes(søgning)) ||
                (f.tone && f.tone.toLowerCase().includes(søgning)) ||
                (f.farvekort && f.farvekort.toLowerCase().includes(søgning))
        );
      });

      renderFarver(filtreret); // Opdater visning
    });

    // Klik på "Tilføj"-knappen for at gemme valgte farver og gå til næste side
    tilfoejKnap.addEventListener("click", function () {
      if (valgteFarver.length > 0) {
        localStorage.setItem("valgteFarver", JSON.stringify(valgteFarver));
        // Gemmer valgte farver i browserens localStorage, så de kan hentes igen på næste side

        window.location.href = "main.html";
        // Gå videre til næste side
      } else {
        alert("Du skal vælge mindst én farve før du kan fortsætte.");
      }
    });

    // Dynamisk opbygning af dropdown-filtre for grundfarve, farvekort og tone
    filters.forEach(filter => {
      const type = filter.dataset.filter; // Hvilken type filter det er (fx "tone")
      const dropdown = document.createElement("div");
      dropdown.className = "dropdown-options";

      // Find unikke værdier for den aktuelle filtertype
      const værdier = [...new Set(colorData.map(f => f[type]).filter(Boolean))];

      værdier.forEach(val => {
        const label = document.createElement("label");
        const checkbox = document.createElement("input");
        checkbox.type = "checkbox";
        checkbox.value = val;

        // Når brugeren vælger/fravælger en filtermulighed
        checkbox.addEventListener("change", () => {
          if (checkbox.checked) {
            aktiveFiltre[type].add(val);
          } else {
            aktiveFiltre[type].delete(val);
          }
          filtrerFarver(); // Opdater farver
        });

        label.appendChild(checkbox);
        label.appendChild(document.createTextNode(val));
        dropdown.appendChild(label);
      });

      filter.appendChild(dropdown);

      // Klik på filterknappen åbner/lukker dropdown
      filter.addEventListener("click", (e) => {
        e.stopPropagation(); // Forhindrer at klik bobler op til document

        const alleredeÅben = filter.classList.contains("open");
        filters.forEach(f => f.classList.remove("open"));
        if (!alleredeÅben) {
          filter.classList.add("open");
        }
      });
    });

    // Når der klikkes udenfor dropdowns, lukkes alle åbne
    document.addEventListener("click", () => {
      filters.forEach(f => f.classList.remove("open"));
    });

    // Initial visning: vis alle farver uden filtrering
    renderFarver(colorData);
  });

</script>

</body>
</html>


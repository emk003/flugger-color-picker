<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <script src="https://kit.fontawesome.com/a4b7cedec2.js" crossorigin="anonymous"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Actor&family=Inter:ital,opsz,wght@0,14..32,100..900;1,14..32,100..900&family=Space+Grotesk:wght@300..700&display=swap" rel="stylesheet">
  <title>Farvevælger</title>
  <style>
    body {
      margin: 0;
      font-family: "Inter", sans-serif;
      background-color: white;
      text-align: center;
    }
    header {
      background-color: white;
    }
    .ej-USP-bar-ek {
      background-color: #363433;
      padding: 0.5rem;
      color: white;
    }
    .ej-header-indhold-ek {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 1rem 2rem;
    }
    .ej-logo-ek {
      max-width: 150px;
    }
    .ej-ikoner-ek {
      display: flex;
      gap: 1rem;
      font-size: 1.8rem;
    }
    /* Topmenu til valg ("vælg farve" / "farvelæg") */
    .valg-ek {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 2rem;
      background-color: white;
      margin-top: 2rem;
    }

    /* Lodret streg mellem valg */
    .opdeler-ek {
      width: 1px;
      align-self: stretch;
      background-color: black;
    }

    /* Den valgte sektion får understregning */
    .valgt-ek {
      border-bottom: 2px solid #000;
      padding-bottom: 0.2rem;
    }

    /* Ikke-valgte er normal i stilen */
    .ikke-valgt-ek {
      font-weight: normal;
    }

    .valgt-ek a {
      text-decoration: none;
      color: inherit;
    }
    .ej-container {
      position: relative;
      display: inline-block;
      max-width: 500px;
      width: 100%;
    }
    .ej-room-image {
      width: 100%;
      display: block;
    }
    .ej-color-layer {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: transparent;
      mask-image: url('foto/Group 75.png');
      -webkit-mask-image: url('foto/Group 75.png');
      mask-size: cover;
      -webkit-mask-size: cover;
      mask-repeat: no-repeat;
      -webkit-mask-repeat: no-repeat;
      mask-position: center;
      -webkit-mask-position: center;
      opacity: 0.8;
      pointer-events: none;
    }
    .ej-toggle-button {
      position: absolute;
      top: 15px;
      left: 15px;
      cursor: pointer;
      z-index: 1;
    }
    .ej-toggle-switch {
      position: relative;
      width: 70px;
      height: 40px;
      background-color: white;
      border-radius: 30px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 0 6px;
      box-shadow: 0 0 5px rgba(0, 0, 0, 0.2);
    }
    .ej-icon {
      font-size: 20px;
      pointer-events: none;
    }
    .ej-slider {
      position: absolute;
      top: 2px;
      left: 3px;
      width: 36px;
      height: 36px;
      background-color: orange;
      border-radius: 50%;
      transition: left 0.5s ease, background-color 0.3s ease;
    }
    .color-wrapper-ek {
      display: flex;
      flex-direction: row;
      gap: 10px;
      flex-grow: 1;
    }

    .color-row-ek {
      display: flex;
      align-items: center;
      gap: 10px;
      padding: 1rem;
      overflow-x: auto;
    }

    .add-box-ek {
      flex-shrink: 0;
    }

    .color-box-ek {
      width: 80px;
      height: 80px;
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-size: 24px;
      cursor: pointer;
      position: relative;
      flex-direction: column;
      flex-shrink: 0;
      overflow: hidden;
      background-size: cover;
      background-position: center;
    }
    .color-box-ek.expanded-ek {
      width: 220px;
      align-items: flex-start;
      justify-content: flex-start;
    }
    .icon-ek { font-size: 24px; }
    .color-box-ek.expanded-ek .icon-ek { opacity: 0; }
    .info-ek {
      position: absolute;
      bottom: 10px;
      left: 10px;
      font-size: 14px;
      display: none;
      color: white;
      text-align: left;
    }
    .color-box-ek.expanded-ek .info-ek { display: block; }
    .trash-ek {
      position: absolute;
      top: 8px;
      right: 8px;
      font-size: 16px;
      display: none;
      color: white;
    }
    .color-box-ek.expanded-ek .trash-ek { display: block; }

    .match-sektion-ek {
      margin: 1rem auto;
      padding: 1rem;
      max-width: 83%;
      border: 1px solid black;
    }
    .match-toggle-ek {
      display: flex;
      justify-content: space-between;
      align-items: center;
      cursor: pointer;
    }
    .match-liste-ek {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
    }
    .similar-color-ek {
      width: 70px;
      height: 70px;
      position: relative;
      flex-shrink: 0;
      background-size: cover;
      background-position: center;
      cursor: pointer;
      margin-top: 1rem;
    }

    .plus-icon-ek {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      font-size: 1.5rem;
      color: black;
      background: rgba(255,255,255,0.8);
      border-radius: 50%;
      width: 24px;
      height: 24px;
      text-align: center;
      line-height: 24px;
    }
    .hidden-ek { display: none; }

    .add-box-ek {
      background-color: white;
      color: black;
      border: 1px solid black;
      font-size: 30px;
      text-decoration: none;
      display: flex;
      align-items: center;
      justify-content: center;
    }


    .see-similar-btn-ej {
      width: 92%;
      padding: 17px;
      margin: 20px 0;
      border: 1px solid black;
      background-color: white;
      font-size: 16px;
      cursor: pointer;
    }

    .ej-button-group {
      display: flex;
      justify-content: flex-end;
      gap: 10px;
      margin-top: 20px;
    }

    .ej-icon-button,
    .ej-text-button {
      border: 1px solid #000;
      background: #fff;
      padding: 8px 12px;
      cursor: pointer;
      font-size: 16px;
      display: flex;
      align-items: center;
      justify-content: center;
      text-decoration: none;
    }

    a{
      text-decoration: none;
    }

    .ej-popup {
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.4s ease;
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgb(255, 255, 255);
      z-index: 10;
      display: flex;
      justify-content: center;
      align-items: center;
    }

    .ej-popup.ej-visible {
      opacity: 1;
      pointer-events: auto;
    }

    .ej-popup-content {
      max-width: 90%;
      max-height: 90%;
      width: auto;
      height: auto;
    }

    .ej-icon-button img {
      width: 19px;
      height: 19px;
      object-fit: contain;
    }




    /* The Modal (background) */
    .modal-ej {
      display: none; /* Hidden by default */
      position: fixed; /* Stay in place */
      z-index: 1; /* Sit on top */
      left: 0;
      top: 0;
      width: 100%; /* Full width */
      height: 100%; /* Full height */
      overflow: auto; /* Enable scroll if needed */
      background-color: rgb(0,0,0); /* Fallback color */
      background-color: rgba(0,0,0,0.4); /* Black w/ opacity */
    }

    /* Modal Content/Box */
    .modal-content {
      background-color: #fefefe;
      margin: 15% auto; /* 15% from the top and centered */
      padding: 20px;
      border: 1px solid #888;
      width: 80%; /* Could be more or less, depending on screen size */
    }

    /* The Close Button */
    .close {
      color: #aaa;
      float: right;
      font-size: 28px;
      font-weight: bold;
    }

    .close:hover,
    .close:focus {
      color: black;
      text-decoration: none;
      cursor: pointer;
    }

    #myBtn1{
      width: 92%;
      padding: 17px;
      background-color: #2333cc;
      color: white;
      font-size: 16px;
      font-weight: bold;
      border: none;
      cursor: pointer;
    }


    .modal-content-ej {
      background: white;
      padding: 4rem;
      margin-top: 150px;
      border-radius: 1px;
      max-width: 250px;
      width: 90%;
      text-align: center;
      font-family: sans-serif;
    }

    .color-item-ej {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 0.75rem;
      padding: 0.5rem 0;
      border-bottom: 1px solid #ddd;
    }

    .color-swatch-ej {
      width: 40px;
      height: 40px;
      border-radius: 1px;
    }

    .trash-icon {
      cursor: pointer;
      font-size: 18px;
    }

    .modal-buttons-ej {
      display: flex;
      justify-content: space-between;
      margin-top: 1.5rem;
      gap: 1rem;
    }

    .modal-btn-ej {
      flex: 1;
      padding: 12px;
      font-size: 16px;
      cursor: pointer;
      border: none;
    }

    .modal-btn-ej.cancel {
      background: white;
      border: 1px solid black;
    }

    .modal-btn-ej.confirm {
      background: #1D3CE5;
      color: white;
    }







  </style>
</head>
<body>
<header>
  <div class="ej-USP-bar-ek">30 dages returret</div>
  <div class="ej-header-indhold-ek">
    <img class="ej-logo-ek" src="fotos/logo.png" alt="logo">
    <div class="ej-ikoner-ek">
      <i class="fa-solid fa-magnifying-glass"></i>
      <i class="fa-solid fa-basket-shopping"></i>
      <i class="fa-solid fa-bars"></i>
    </div>
  </div>
</header>

<div class="valg-ek">
  <h2 class="valgt-ek"><a href="vælgfarve.html">Vælg farve</a></h2>
  <div class="opdeler-ek"></div>
  <h2 class="ikke-valgt-ek">Farvelæg</h2>
</div>

<div class="ej-container">
  <div class="ej-toggle-button" onclick="toggleDayNight()">
    <div class="ej-toggle-switch">
      <span class="ej-icon">☀️</span>
      <span class="ej-icon">🌙</span>
      <div class="ej-slider" id="ej-slider"></div>
    </div>
  </div>

  <img id="ej-mainImage" class="ej-room-image" src="foto/Frame 58.jpg" alt="Room">
  <div id="ej-colorLayer" class="ej-color-layer"></div>

<div class="ej-popup" id="ej-popup">
  <img src="foto/Group 116.png" class="ej-popup-content" alt="Popup Image">
</div>

</div>


<div class="ej-button-group">
  <button class="ej-icon-button" id="ej-popupBtn">
    <img src="foto/Compare.png" alt="Ikon" width="20" height="20">
  </button>
  <a href="vælgbillede.html">
    <button class="ej-text-button">Skift billede</button>
  </a>
</div>


<div class="color-row-ek">
    <a href="vælgfarve.html" class="color-box-ek add-box-ek">+</a>
    <div class="color-wrapper-ek" id="colorWrapper-ek"></div>
</div>

<div class="match-sektion-ek">
  <div id="matchToggle-ek" class="match-toggle-ek">
    <span>Se lignende farver</span>
    <i class="fa-solid fa-chevron-down"></i>
  </div>
  <div id="matchListe-ek" class="match-liste-ek hidden-ek">Klik først på en farve</div>
</div>



<!-- Trigger/Open The Modal = "Gå til kurv" knap og popup -->
<button id="myBtn1">Gå til kurv</button>

<!-- The Modal -->
<div id="myModal1" class="modal-ej">

  <!-- Modal content -->
  <div class="modal-content-ej">
    <span class="close">&times;</span>
    <h2>Vil du tilføje disse<br><strong>3 farveprøver</strong> til din kurv</h2>

    <div class="color-item-ej">
      <div class="color-swatch-ej" style="background-color: #DADAC0;"></div>
      <div>
        <strong>Pocket Green</strong><br>
        FL8067
      </div>
      <div>4,95 kr.</div>
      <div class="trash-icon">🗑️</div>
    </div>

    <div class="color-item-ej">
      <div class="color-swatch-ej" style="background-color: #B8C3C6;"></div>
      <div>
        <strong>Bornholm</strong><br>
        FL8040
      </div>
      <div>4,95 kr.</div>
      <div class="trash-icon">🗑️</div>
    </div>

    <div class="color-item-ej">
      <div class="color-swatch-ej" style="background-color: #4E5A44;"></div>
      <div>
        <strong>Lund</strong><br>
        FL8067
      </div>
      <div>4,95 kr.</div>
      <div class="trash-icon">🗑️</div>
    </div>

    <div class="modal-buttons-ej">
      <button class="modal-btn-ej cancel">Nej</button>
      <button class="modal-btn-ej confirm">Ja</button>
    </div>
  </div>
</div>


<div>
  <button class="see-similar-btn-ej">Gem mine farver</button>
</div>





<script src="database.js"></script>
<script>
  const wrapper = document.getElementById("colorWrapper-ek");
  const matchToggle = document.getElementById("matchToggle-ek");
  const matchListe = document.getElementById("matchListe-ek");
  const layer = document.getElementById("ej-colorLayer");

  const farver = JSON.parse(localStorage.getItem("valgteFarver")) || [];

  function setColor(color) {
    layer.style.backgroundColor = color;
  }

  farver.forEach(f => {
    const box = document.createElement("div");
    box.className = "color-box-ek";
    box.style.backgroundColor = f.hex;
    if (f.type === "effekt" && f.tekstur) {
      box.style.backgroundImage = `url(${f.tekstur})`;
      box.style.backgroundBlendMode = "multiply";
    }
    const icon = document.createElement("div");
    icon.className = "icon-ek";
    icon.innerHTML = '<i class="fa-solid fa-brush"></i>';
    const info = document.createElement("div");
    info.className = "info-ek";
    info.innerHTML = `<strong>${f.navn}</strong><br>${f.kode}`;
    const trash = document.createElement("div");
    trash.className = "trash-ek";
    trash.innerHTML = '<i class="fas fa-trash-alt"></i>';
    trash.addEventListener("click", e => {
      e.stopPropagation();
      const nyeFarver = farver.filter(farve => farve.kode !== f.kode);
      localStorage.setItem("valgteFarver", JSON.stringify(nyeFarver));
      location.reload();
    });
    box.addEventListener("click", () => {
      document.querySelectorAll(".color-box-ek.expanded-ek").forEach(b => b !== box && b.classList.remove("expanded-ek"));
      box.classList.toggle("expanded-ek");
      setColor(f.hex);
    });
    box.appendChild(icon);
    box.appendChild(info);
    box.appendChild(trash);
    wrapper.appendChild(box);
  });

  matchToggle.addEventListener("click", () => {
    const aktivBoks = document.querySelector(".color-box-ek.expanded-ek");
    const ikon = matchToggle.querySelector("i");
    if (!matchListe.classList.contains("hidden-ek")) {
      matchListe.classList.add("hidden-ek");
      ikon.classList.remove("fa-chevron-up");
      ikon.classList.add("fa-chevron-down");
      return;
    }
    if (!aktivBoks) {
      matchListe.innerHTML = "<em>Vælg først en farve ovenover</em>";
      matchListe.classList.remove("hidden-ek");
      return;
    }
    const rgb = getComputedStyle(aktivBoks).backgroundColor;
    const aktivHex = rgbToHex(rgb);
    const aktivData = farver.find(f => f.hex.toUpperCase() === aktivHex);
    if (!aktivData) {
      matchListe.innerHTML = "<em>Vi fandt desværre ikke en lignende farve</em>";
      return;
    }
    const lignende = colorData.filter(f => f.kode !== aktivData.kode && f.grundfarve === aktivData.grundfarve).slice(0, 4);
    matchListe.innerHTML = "";
    matchListe.classList.remove("hidden-ek");
    ikon.classList.remove("fa-chevron-down");
    ikon.classList.add("fa-chevron-up");
    lignende.forEach(f => {
      const box = document.createElement("div");
      box.className = "similar-color-ek";
      box.style.backgroundColor = f.hex;
      if (f.type === "effekt" && f.tekstur) {
        box.style.backgroundImage = `url(${f.tekstur})`;
        box.style.backgroundBlendMode = "multiply";
      }
      const plus = document.createElement("div");
      plus.className = "plus-icon-ek";
      plus.textContent = "+";
      plus.addEventListener("click", e => {
        e.stopPropagation();
        const gemte = JSON.parse(localStorage.getItem("valgteFarver")) || [];
        if (!gemte.find(v => v.kode === f.kode)) {
          gemte.push(f);
          localStorage.setItem("valgteFarver", JSON.stringify(gemte));
          location.reload();
        }
      });
      box.appendChild(plus);
      matchListe.appendChild(box);
    });
  });

  function rgbToHex(rgb) {
    const result = rgb.match(/\d+/g);
    return "#" + result.map(x => parseInt(x).toString(16).padStart(2, "0")).join("").toUpperCase();
  }

  let isDay = true;
  function toggleDayNight() {
    const image = document.getElementById('ej-mainImage');
    const slider = document.getElementById('ej-slider');
    isDay = !isDay;
    image.src = isDay ? 'foto/Frame 58.jpg' : 'foto/Group 115.jpg';
    slider.style.left = isDay ? '2px' : '44px';
    slider.style.backgroundColor = isDay ? 'orange' : 'black';
  }

  const popup = document.getElementById("ej-popup");
  const popupBtn = document.getElementById("ej-popupBtn");

  popupBtn.addEventListener("click", () => {
    popup.classList.toggle("ej-visible");
  });



  //Dette er til den første popup model "Gå til kurv"
  // Get the modal
  var modal = document.getElementById("myModal1");

  // Get the button that opens the modal
  var btn = document.getElementById("myBtn1");

  // Get the <span> element that closes the modal
  var span = document.getElementsByClassName("close")[0];

  // When the user clicks on the button, open the modal
  btn.onclick = function() {
    modal.style.display = "block";
  }

  // When the user clicks on <span> (x), close the modal
  span.onclick = function() {
    modal.style.display = "none";
  }

  // When the user clicks anywhere outside of the modal, close it
  window.onclick = function(event) {
    if (event.target == modal) {
      modal.style.display = "none";
    }
  }

  // Hent knapperne
  const cancelButton = document.querySelector('.modal-btn-ej.cancel');
  const confirmButton = document.querySelector('.modal-btn-ej.confirm');

  // Luk modal, når man klikker "Nej"
  cancelButton.addEventListener('click', function () {
    modal.style.display = 'none';
  });

  // Luk modal, når man klikker "Ja"
  confirmButton.addEventListener('click', function () {
    modal.style.display = 'none';
    // Her kan du evt. tilføje funktionalitet til at gå til kurven
  });



</script>
</body>
</html>